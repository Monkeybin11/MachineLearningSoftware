<TabItem x:Class="MachineLearningSoftware.Views.Controls.MainWindowTabItem"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" Height="Auto" Width="Auto" Style="{DynamicResource TabItem}"
             MouseDown="OnMiddleClickTabItem">

    <TabItem.Resources>
        <Style x:Key="TabItem" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border Name="Border" BorderThickness="1,1,1,0" BorderBrush="Black" CornerRadius="2,2,0,0" Margin="-2,0,3,0">
                            <ContentPresenter x:Name="ContentSite"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Center"
                                    ContentSource="Header"
                                    Margin="10,2"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#FF5F9CFF" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="False">
                                <Setter TargetName="Border" Property="Background" Value="White" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="HoverOnCloseButton" TargetType="{x:Type Border}">
            <Setter Property="Border.Background" Value="Transparent"/>
            <Style.Triggers>
                <Trigger Property="Border.IsMouseOver" Value="True">
                </Trigger>

                <EventTrigger RoutedEvent="MouseEnter">
                    <EventTrigger.Actions>
                        <BeginStoryboard>
                            <Storyboard>
                                <ColorAnimation To="Black" 
                                        Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" 
                                        FillBehavior="HoldEnd" 
                                        Duration="0:0:0.100"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger.Actions>
                </EventTrigger>

                <EventTrigger RoutedEvent="MouseLeave">
                    <EventTrigger.Actions>
                        <BeginStoryboard>
                            <Storyboard>
                                <ColorAnimation To="Red" 
                                        Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)" 
                                        FillBehavior="HoldEnd" 
                                        Duration="0:0:0.100"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger.Actions>
                </EventTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="TransparentButton" TargetType="Button">
            <Setter Property="OverridesDefaultStyle" Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Name="border" BorderThickness="0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </TabItem.Resources>

    <TabItem.Header>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock x:Name="Header" Grid.Column="0" Margin="0,0,10,0" VerticalAlignment="Center"  
                           FontSize="12"/>
            <Button Grid.Column="1" Background="Transparent" BorderThickness="0" Click="OnCloseTabButton" Style="{StaticResource TransparentButton}">
                <Border HorizontalAlignment="Right"  Width="16" Height="16" Background="Red" CornerRadius="5" Style="{StaticResource HoverOnCloseButton}">
                    <Path xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Fill="White" StrokeThickness="0.18570621" Stroke="#FF000000" 
                          StrokeMiterLimit="4" StrokeLineJoin="Round" StrokeStartLineCap="Flat" StrokeEndLineCap="Flat" Opacity="1" 
                          Data="m 6.8909397 291.27134 c -0.3542481 -0.1248 -0.6587858 -0.3962 -0.8192484 -0.73017 -0.2161016 -0.4498 -0.1971179 -0.82645 0.061303 -1.21601 0.1168267 -0.17612 1.1195352 -1.26215 2.2282414 -2.41339 1.1087058 -1.15124 2.0158333 -2.14095 2.0158333 -2.19936 0 -0.15535 -0.26184 -0.44333 -2.1882125 -2.40668 -0.9575323 -0.97592 -1.8110911 -1.86841 -1.8968031 -1.98333 -0.2275062 -0.30501 -0.2241695 -1.15261 0.0059 -1.49509 0.3380026 -0.5032 1.2028886 -0.73204 1.6735935 -0.4428 0.2333437 0.14337 1.6029609 1.44636 3.4127271 3.2467 l 1.115014 1.10921 1.005414 -1.02112 c 1.325771 -1.34649 3.249799 -3.16952 3.520914 -3.33612 0.485781 -0.29848 1.376159 -0.0275 1.676048 0.51014 0.185599 0.33273 0.206621 0.83527 0.05065 1.21136 -0.06414 0.1547 -0.810033 0.98133 -1.876698 2.07988 -0.973636 1.00271 -1.896791 1.97515 -2.051453 2.16094 l -0.281207 0.33782 0.299557 0.35021 c 0.164754 0.19262 1.128991 1.21536 2.142752 2.27276 1.013762 1.05741 1.898536 2.04006 1.966174 2.18366 0.169792 0.36053 0.154302 0.61821 -0.06368 1.05893 -0.20476 0.41403 -0.606625 0.7117 -1.061148 0.786 -0.467067 0.0764 -0.762927 -0.15627 -3.053765 -2.40132 -1.199627 -1.17565 -2.225015 -2.13754 -2.278643 -2.13754 -0.103962 0 -1.039327 0.88139 -3.20787 3.02276 -1.5558338 1.53635 -1.7768949 1.67039 -2.3953959 1.45256 z" 
                          Margin="3" Stretch="Fill"/>
                </Border>                
            </Button>
        </Grid>
    </TabItem.Header>
</TabItem>
